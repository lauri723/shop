<% layout('layouts/boilerplate')%>

<div class="row">
    <div class="col-md-7 mb-3 mb-md-5">
        <div id="carousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                <% listing.photos.forEach((photo, i) => {  %>
                <div class="carousel-item <%= i === 0 ? 'active' : ''%>" data-bs-interval="3000">
                    <img src="<%= photo.url%>" class="d-block w-100" alt="">
                </div>
                <% }) %>
            </div>
            <% if(listing.photos.length > 1) {%>
            <a class="carousel-control-prev" type="button" data-bs-target="#carousel"  data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <!-- <span class="sr-only">Previous</span> -->
            </a>
            <a class="carousel-control-next" type="button" data-bs-target="#carousel"  data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <!-- <span class="sr-only">Next</span> -->
            </a>
            <% } %>
        </div>
    </div>
    
    <div class="col-md-5 mb-3 mb-md-5">
        <div class="card p-3">
            <div class="card-body">
                <h3 class="card-title"> <%= listing.title %></h3>
                <h6 class="card-subtitle mb-2 text-muted"><%= listing.notation %></h6>
                <hr>
                <h5 class="card-text price mb-3">
                    $<%= listing.price.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2}) %></h5>
                <a class="btn btn-sm btn-info px-5" href="/cart/add/<%= listing.slug %>">Add to Cart</a>
            </div>
            <div class="card-body">
                <p class="card-text description"><%= listing.description %></p>
                <hr>
                <p class="card-text materials">Materials: <%= listing.materials %></p>
                <hr>
                <p class="card-text tags">#<%= listing.tags %></p>
            </div>
            <div class="card-footer">
                <a class="btn btn-sm btn-success px-5" href="/sections/<%=section_id%>">Back to Section</a>
            </div>
            <div class="card-footer second-footer text-center">
                <%  if( currentUser && listing.author.equals(currentUser._id))  {%>
                    <a class="btn btn-sm btn-primary px-4" href="/sections/<%=section_id%>/listings/<%=listing._id%>/edit">Edit</a>
                    <form class="d-inline" action="/sections/<%=section_id%>/listings/<%=listing._id%>/?_method=DELETE" method="POST">
                        <button class="btn btn-sm btn-danger">Delete</button>
                    </form>
                    <!-- <form action="sections/<%= section_id %>/listings/<%=listing._id%>?_method=DELETE" method="POST">
                        <button class="btn btn-sm btn-danger px-4">Delete</button>
                    </form> -->
                <% } %>
            </div>
        </div>
        
    </div>
</div>

<div>
    
</div>